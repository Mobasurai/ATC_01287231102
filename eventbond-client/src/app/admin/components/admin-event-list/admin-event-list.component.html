<div class="container mx-auto px-4 py-8">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold text-gray-800">Manage Events</h1>
    <button (click)="navigateToCreateEvent()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:-translate-y-px">
      Create New Event
    </button>
  </div>

  <div *ngIf="isLoading$ | async" class="text-center py-10">
    <p class="text-gray-600 text-lg">Loading events...</p>
  </div>

  <div *ngIf="error" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6" role="alert">
    <strong class="font-bold">Error:</strong>
    <span class="block sm:inline">{{ error }}</span>
  </div>

  <ng-container *ngIf="(events$ | async) as events">
    <div *ngIf="!(isLoading$ | async) && events && events.length === 0 && !error" class="text-center py-10 bg-white shadow-lg rounded-lg">
      <p class="text-gray-600 text-xl">No events found.</p>
      <p class="text-gray-500 mt-2">Why not create the first one?</p>
    </div>

    <div *ngIf="!(isLoading$ | async) && events && events.length > 0 && !error" class="bg-white shadow-xl rounded-lg overflow-hidden">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Start Date</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Venue</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Price</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Seats</th>
            <th scope="col" class="relative px-6 py-3">
              <span class="sr-only">Actions</span>
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let event of events" class="hover:bg-gray-50 transition duration-150">
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm font-medium text-gray-900">{{ event.title }}</div>
              <div class="text-sm text-gray-500">{{ event.category?.name || 'N/A' }}</div> <!-- Added optional chaining and fallback -->
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{{ event.startDate | date: 'mediumDate' }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{{ event.venue }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{{ event.price | currency }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{{ event.seatsAvailable }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2">
              <button (click)="editEvent(event.id)" class="text-indigo-600 hover:text-indigo-900 transition duration-150">Edit</button>
              <button (click)="deleteEvent(event.id)" class="text-red-600 hover:text-red-900 transition duration-150">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </ng-container>

</div>
